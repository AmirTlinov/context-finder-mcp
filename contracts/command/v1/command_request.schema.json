{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "contracts/command/v1/command_request.schema.json",
  "title": "Context CommandRequest (v1)",
  "type": "object",
  "additionalProperties": false,
  "required": ["action"],
  "properties": {
    "action": {
      "type": "string",
      "description": "Command identifier (snake_case).",
      "enum": [
        "search",
        "search_with_context",
        "context_pack",
        "meaning_pack",
        "meaning_focus",
        "task_pack",
        "text_search",
        "evidence_fetch",
        "batch",
        "capabilities",
        "index",
        "get_context",
        "list_symbols",
        "config_read",
        "compare_search",
        "map",
        "repo_onboarding_pack",
        "eval",
        "eval_compare"
      ]
    },
    "payload": {
      "type": "object",
      "description": "Action-specific payload. Unknown fields are ignored unless the corresponding payload struct opts into strict parsing.",
      "default": {},
      "additionalProperties": true
    },
    "options": {
      "description": "Optional cross-cutting request options (freshness policy, filters, budgets).",
      "default": null,
      "anyOf": [{ "type": "null" }, { "$ref": "./request_options.schema.json" }]
    },
    "config": {
      "description": "Optional per-request config overrides merged into the effective project config.",
      "default": null,
      "type": ["object", "null"],
      "additionalProperties": true
    }
  },
  "$comment": "Rust source of truth: crates/cli/src/command/domain.rs::CommandRequest / CommandAction / RequestOptions"
}
